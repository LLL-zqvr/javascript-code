<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>避免禁选授课时间冲突</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        table,
    table td,
    table th {
        border-collapse: collapse;
    }
    
        table {
            width: 400px;
            text-align: center;
            
        }
    
    table thead {
        background-color: green;
    }
    
    </style>
</head>
<body>
    <table>
        <thead>
           <tr>
                <th>#</th>
                <th>名称</th>
                <th>学分</th>
                <th>起止周</th>
                <th>时间</th>
                <th>教师</th>
                <th>操作</th>
           </tr>
        </thead>
        <tbody>
            <tr>
                <td class="index">1</td>
                <td>数据库原理</td>
                <td>3</td>
                <td class="week">1 - 10</td>
                <td class="day">周1/12节</td>
                <td>谭文韬</td>
                <td><input type="checkbox" name="items"></td>
            </tr>
            <tr>
                <td class="index">2</td>
                <td>Web开发技术</td>
                <td>2.5</td>
                <td class="week">1 - 8</td>
                <td class="day">周1/34节</td>
                <td>徐懿</td>
                <td><input type="checkbox" name="items"></td>
            </tr>
            <tr>
                <td class="index">3</td>
                <td>托福阅读</td>
                <td>2</td>
                <td class="week">1 - 5</td>
                <td class="day">周1/12节</td>
                <td>李景阳</td>
                <td><input type="checkbox" name="items"></td>
                </tr>
            <tr>
                <td class="index">4</td>
                <td>高级英语视听</td>
                <td>2</td>
                <td class="week">3 - 10</td>
                <td class="day">周1/34节</td>
                <td>龙超悦</td>
                <td><input type="checkbox" name="items"></td>
                </tr>
            <tr>
                <td class="index">5</td>
                <td>Web系统框架</td>
                <td>2.5</td>
                <td class="week">10 - 17</td>
                <td class="day">周1/12节</td>
                <td>王子阳</td>
                <td><input type="checkbox" name="items"></td>
                </tr>
    <p></p>
<script src="https://cdn.staticfile.net/jquery/1.10.2/jquery.min.js"></script>
<script>
    $(document).ready(
        () => {
            let clickboxs = $("input[name=items]");
            clickboxs.click(
                function() {
                    function beginWeek(clickbox){
                        return $(clickbox).parent().siblings(".week").text().split(' - ')[0];
                    }
                    function endWeek(clickbox){
                        return $(clickbox).parent().siblings(".week").text().split(' - ')[1];
                    }
                    
                    function day(clickbox){
                        return $(clickbox).parent().siblings(".day").text()[1];
                    }
                    function firstClass(clickbox){
                        return $(clickbox).parent().siblings(".day").text()[3];
                    }
                    function secondClass(clickbox){
                        return $(clickbox).parent().siblings(".day").text()[4];
                    }
                    let len = clickboxs.filter(":checked").length;
                    // 
                    //分割字符串,得到选中课程的起始周和结束周。
                    let begin = beginWeek(clickboxs.filter(":checked")[len-1]);
                    let end = endWeek(clickboxs.filter(":checked")[len-1]);
                    //得到选中课程的上课时间（第几天上课）和上课节数
                    let theday = day(clickboxs.filter(":checked")[len-1]);
                    let first = firstClass(clickboxs.filter(":checked")[len-1]);
                    let second = secondClass(clickboxs.filter(":checked")[len-1]);
                    //
                    let index = $(clickboxs).parent().siblings(".index").text();
                    let clashes;
                    // for(let i=1;i<=index;i++){

                    //     clashes[i] = 
                    // }
                    //分割字符串,得到选中课程的起始周和结束周。
                    // let begin = beginWeek(clickboxs.filter(this));
                    // let end = endWeek(clickboxs.filter(this));
                    // //得到选中课程的上课时间（第几天上课）和上课节数
                    // let theday = day(clickboxs.filter(this));
                    // let first = firstClass(clickboxs.filter(this));
                    // let second = secondClass(clickboxs.filter(this));

                    // clickboxs.not(":checked")
                    // .filter( 
                    // function(){
                        
                    //      return ((beginWeek(this)>=begin&&beginWeek(this)<=end)||(endWeek(this)>=begin&&endWeek(this)<=end))
                    //             &&(day(this)==theday)
                    //             &&(firstClass(this)==first)
                    //             ;
                    // })
                    // .prop("disabled",true);
                    console.log(begin+" "+end+" "+theday+" "+first+" "+second);
                    clickboxs.not(":checked")
                    .each( 
                    function (){
                        
                        //   let result = ((beginWeek(this)>=begin&&beginWeek(this)<=end)||(endWeek(this)>=begin&&endWeek(this)<=end))
                        //         &&(day(this)==theday)
                        //         &&(firstClass(this)==first);
                        //       $(this).prop("disabled",result); 
                        let lenth = clickboxs.filter(":checked").length;
                        if(
                            ((beginWeek(this)>=begin&&beginWeek(this)<=end)||(endWeek(this)>=begin&&endWeek(this)<=end))
                                 &&(day(this)==theday)
                                 &&(firstClass(this)==first)
                                
                                )
                                 {
                                    $(this).prop("disabled",true); 
                                    }
                         //if(flag==1&&lenth>1)$(this).prop("disabled",false); 

                                 
                                 
                    }
                )



                }
            );
        }
    );
</script>
        </tbody>
    </table>
</body>
</html>